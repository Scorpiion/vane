
<!DOCTYPE html>
<html>
<head><script src="//archive.org/includes/analytics.js?v=cf34f82" type="text/javascript"></script>
<script type="text/javascript">window.addEventListener('DOMContentLoaded',function(){var v=archive_analytics.values;v.service='wb';v.server_name='wwwb-app56.us.archive.org';v.server_ms=465;archive_analytics.send_pageview({});});</script>
<script type="text/javascript" src="/static/js/ait-client-rewrite.js?v=1544499711.0" charset="utf-8"></script>
<script type="text/javascript">
WB_wombat_Init('https://web.archive.org/web', '20140525025619', 'www.dartvoid.com:80');
</script>
<script type="text/javascript" src="/static/js/wbhack.js?v=1544499711.0" charset="utf-8"></script>
<script type="text/javascript">
__wbhack.init('https://web.archive.org/web');
</script>
<link rel="stylesheet" type="text/css" href="/static/css/banner-styles.css?v=1544499711.0" />
<link rel="stylesheet" type="text/css" href="/static/css/iconochive.css?v=1544499711.0" />
<!-- End Wayback Rewrite JS Include -->

  <title>DartVoid &middot; Database access</title>
  
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
  <meta name="description" content="A hosting platform with easy deployment of your full-stack Dart applications.">
    
  <!-- FA CSS -->
  <script type="text/javascript">window.mod_pagespeed_start = Number(new Date());</script><link rel="stylesheet" href="https://web.archive.org/web/20140525025619cs_/http://1-ps.googleusercontent.com/x/s.dartvoid-home.appspot.com/www.dartvoid.com/assets/css/A.font-awesome.min.css.pagespeed.cf.ANtKJDqMTP.css">
  
  <!-- Bootstrap CSS -->
  <link rel="stylesheet" href="/web/20140525025619cs_/http://www.dartvoid.com:80/assets/css/bootstrap.min.css">
  
  <!-- Site CSS -->
  <link rel="stylesheet" href="/web/20140525025619cs_/http://www.dartvoid.com:80/assets/css/style.css">
  
  <!-- Favicon -->
  <link rel="shortcut icon" href="/web/20140525025619im_/http://www.dartvoid.com:80/assets/img/favicon.png">
  
  <!-- Bootstrap JS -->
  <script src="//web.archive.org/web/20140525025619js_/http://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
  <script type="text/javascript" src="https://web.archive.org/web/20140525025619js_/http://1-ps.googleusercontent.com/x/s.dartvoid-home.appspot.com/www.dartvoid.com/assets/js/bootstrap.min.js.pagespeed.jm.VAXfsJsT7y.js"></script>
  
  <!-- GA -->
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','//web.archive.org/web/20140525025619/http://www.google-analytics.com/analytics.js','ga');ga('create','UA-35167322-1','dartvoid.com');ga('send','pageview');</script>
  
  <!-- GPLUS -->
  <script async type="text/javascript" src="https://web.archive.org/web/20140525025619js_/https://apis.google.com/js/plusone.js"></script>
  
  <!-- Twitter -->
  <script async>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+"://platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
</head>


<body><!-- BEGIN WAYBACK TOOLBAR INSERT -->
<script type="text/javascript" src="/static/js/timestamp.js?v=1544499711.0" charset="utf-8"></script>
<script type="text/javascript" src="/static/js/graph-calc.js?v=1544499711.0" charset="utf-8"></script>
<script type="text/javascript" src="/static/js/auto-complete.js?v=1544499711.0" charset="utf-8"></script>
<script type="text/javascript" src="/static/js/toolbar.js?v=1544499711.0" charset="utf-8"></script>
<style type="text/css">
body {
  margin-top:0 !important;
  padding-top:0 !important;
  /*min-width:800px !important;*/
}
.wb-autocomplete-suggestions {
    text-align: left; cursor: default; border: 1px solid #ccc; border-top: 0; background: #fff; box-shadow: -1px 1px 3px rgba(0,0,0,.1);
    position: absolute; display: none; z-index: 2147483647; max-height: 254px; overflow: hidden; overflow-y: auto; box-sizing: border-box;
}
.wb-autocomplete-suggestion { position: relative; padding: 0 .6em; line-height: 23px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; font-size: 1.02em; color: #333; }
.wb-autocomplete-suggestion b { font-weight: bold; }
.wb-autocomplete-suggestion.selected { background: #f0f0f0; }
</style>
<div id="wm-ipp" lang="en" style="display:none;direction:ltr;">
<div style="position:fixed;left:0;top:0;right:0;">
<div id="wm-ipp-inside">
  <div style="position:relative;">
    <div id="wm-logo" style="float:left;width:130px;padding-top:10px;">
      <a href="/web/" title="Wayback Machine home page"><img src="/static/images/toolbar/wayback-toolbar-logo.png" alt="Wayback Machine" width="110" height="39" border="0" /></a>
    </div>
    <div class="r" style="float:right;">
      <div id="wm-btns" style="text-align:right;height:25px;">
                  <div id="wm-save-snapshot-success">success</div>
          <div id="wm-save-snapshot-fail">fail</div>
          <a href="#"
             onclick="__wm.saveSnapshot('http://www.dartvoid.com:80/vane/databases/', '20140525025619')"
             title="Share via My Web Archive"
             id="wm-save-snapshot-open"
          >
            <span class="iconochive-web"></span>
          </a>
          <a href="https://archive.org/account/login.php"
             title="Sign In"
             id="wm-sign-in"
          >
            <span class="iconochive-person"></span>
          </a>
          <span id="wm-save-snapshot-in-progress" class="iconochive-web"></span>
        	<a href="http://faq.web.archive.org/" title="Get some help using the Wayback Machine" style="top:-6px;"><span class="iconochive-question" style="color:rgb(87,186,244);font-size:160%;"></span></a>
	<a id="wm-tb-close" href="#close" onclick="__wm.h(event);return false;" style="top:-2px;" title="Close the toolbar"><span class="iconochive-remove-circle" style="color:#888888;font-size:240%;"></span></a>
      </div>
      <div id="wm-share" style="text-align:right;">
	<a href="#" onclick="window.open('https://www.facebook.com/sharer/sharer.php?u=https://web.archive.org/web/20140525025619/http://www.dartvoid.com:80/vane/databases/', '', 'height=400,width=600'); return false;" title="Share on Facebook" style="margin-right:5px;" target="_blank"><span class="iconochive-facebook" style="color:#3b5998;font-size:160%;"></span></a>
	<a href="#" onclick="window.open('https://twitter.com/intent/tweet?text=https://web.archive.org/web/20140525025619/http://www.dartvoid.com:80/vane/databases/&amp;via=internetarchive', '', 'height=400,width=600'); return false;" title="Share on Twitter" style="margin-right:5px;" target="_blank"><span class="iconochive-twitter" style="color:#1dcaff;font-size:160%;"></span></a>
      </div>
    </div>
    <table class="c" style="">
      <tbody>
	<tr>
	  <td class="u" colspan="2">
	    <form target="_top" method="get" action="/web/submit" name="wmtb" id="wmtb"><input type="text" name="url" id="wmtbURL" value="http://www.dartvoid.com:80/vane/databases/" onfocus="this.focus();this.select();" /><input type="hidden" name="type" value="replay" /><input type="hidden" name="date" value="20140525025619" /><input type="submit" value="Go" /></form>
	  </td>
	  <td class="n" rowspan="2" style="width:110px;">
	    <table>
	      <tbody>
		<!-- NEXT/PREV MONTH NAV AND MONTH INDICATOR -->
		<tr class="m">
		  <td class="b" nowrap="nowrap">Apr</td>
		  <td class="c" id="displayMonthEl" title="You are here: 02:56:19 May 25, 2014">MAY</td>
		  <td class="f" nowrap="nowrap">Jun</td>
		</tr>
		<!-- NEXT/PREV CAPTURE NAV AND DAY OF MONTH INDICATOR -->
		<tr class="d">
		  <td class="b" nowrap="nowrap"><img src="/static/images/toolbar/wm_tb_prv_off.png" alt="Previous capture" width="14" height="16" border="0" /></td>
		  <td class="c" id="displayDayEl" style="width:34px;font-size:24px;white-space:nowrap;" title="You are here: 02:56:19 May 25, 2014">25</td>
		  <td class="f" nowrap="nowrap"><img src="/static/images/toolbar/wm_tb_nxt_off.png" alt="Next capture" width="14" height="16" border="0" /></td>
		</tr>
		<!-- NEXT/PREV YEAR NAV AND YEAR INDICATOR -->
		<tr class="y">
		  <td class="b" nowrap="nowrap">2013</td>
		  <td class="c" id="displayYearEl" title="You are here: 02:56:19 May 25, 2014">2014</td>
		  <td class="f" nowrap="nowrap">2015</td>
		</tr>
	      </tbody>
	    </table>
	  </td>
	</tr>
	<tr>
	  <td class="s">
	    	    <div id="wm-nav-captures">
	      	      <a class="t" href="/web/20140525025619*/http://www.dartvoid.com:80/vane/databases/" title="See a list of every capture for this URL">1 capture</a>
	      <div class="r" title="Timespan for captures of this URL">25 May 2014</div>
	      </div>
	  </td>
	  <td class="k">
	    <a href="" id="wm-graph-anchor">
	      <div id="wm-ipp-sparkline" title="Explore captures for this URL" style="position: relative">
		<canvas id="wm-sparkline-canvas" width="600" height="27" border="0"></canvas>
	      </div>
	    </a>
	  </td>
	</tr>
      </tbody>
    </table>
    <div style="position:absolute;bottom:0;right:2px;text-align:right;">
      <a id="wm-expand" class="wm-btn wm-closed" href="#expand" onclick="__wm.ex(event);return false;"><span id="wm-expand-icon" class="iconochive-down-solid"></span> <span style="font-size:80%">About this capture</span></a>
    </div>
  </div>
    <div id="wm-capinfo" style="border-top:1px solid #777;display:none; overflow: hidden">
            <div style="background-color:#666;color:#fff;font-weight:bold;text-align:center">COLLECTED BY</div>
    <div style="padding:3px;position:relative" id="wm-collected-by-content">
            <div style="display:inline-block;vertical-align:top;width:50%;">
			<span class="c-logo" style="background-image:url(https://archive.org/services/img/alexacrawls);"></span>
		Organization: <a style="color:#33f;" href="https://archive.org/details/alexacrawls" target="_new"><span class="wm-title">Alexa Crawls</span></a>
		<div style="max-height:75px;overflow:hidden;position:relative;">
	  <div style="position:absolute;top:0;left:0;width:100%;height:75px;background:linear-gradient(to bottom,rgba(255,255,255,0) 0%,rgba(255,255,255,0) 90%,rgba(255,255,255,255) 100%);"></div>
	  Starting in 1996, <a href="http://www.alexa.com/">Alexa Internet</a> has been donating their crawl data to the Internet Archive.  Flowing in every day, these data are added to the <a href="http://web.archive.org/">Wayback Machine</a> after an embargo period.
	</div>
	      </div>
      <div style="display:inline-block;vertical-align:top;width:49%;">
			<span class="c-logo" style="background-image:url(https://archive.org/services/img/alexacrawls)"></span>
		<div>Collection: <a style="color:#33f;" href="https://archive.org/details/alexacrawls" target="_new"><span class="wm-title">Alexa Crawls</span></a></div>
		<div style="max-height:75px;overflow:hidden;position:relative;">
	  <div style="position:absolute;top:0;left:0;width:100%;height:75px;background:linear-gradient(to bottom,rgba(255,255,255,0) 0%,rgba(255,255,255,0) 90%,rgba(255,255,255,255) 100%);"></div>
	  Starting in 1996, <a href="http://www.alexa.com/">Alexa Internet</a> has been donating their crawl data to the Internet Archive.  Flowing in every day, these data are added to the <a href="http://web.archive.org/">Wayback Machine</a> after an embargo period.
	</div>
	      </div>
    </div>
    <div style="background-color:#666;color:#fff;font-weight:bold;text-align:center" title="Timestamps for the elements of this page">TIMESTAMPS</div>
    <div>
      <div id="wm-capresources" style="margin:0 5px 5px 5px;max-height:250px;overflow-y:scroll !important"></div>
      <div id="wm-capresources-loading" style="text-align:left;margin:0 20px 5px 5px;display:none"><img src="/static/images/loading.gif" alt="loading" /></div>
    </div>
  </div></div></div></div><script type="text/javascript">
__wm.bt(600,27,25,2,"web","http://www.dartvoid.com:80/vane/databases/","2014-05-25",1996);
</script>
<!-- END WAYBACK TOOLBAR INSERT -->
  <header class="navbar navbar-static-top navbar-inverse">
    <div class="container">
      <div class="navbar-header">
      
        <button class="navbar-toggle collapsed" type="button" data-toggle="collapse" data-target=".navbar-collapse-header">
          <span class="sr-only">Toggle navigation</span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        
        <a href="/web/20140525025619/http://www.dartvoid.com:80/" class="navbar-brand"><span class="title"><strong>DartVoid</strong></span></a>
      </div>
      <nav class="collapse navbar-collapse navbar-collapse-header" role="navigation">
        <ul class="nav navbar-nav navbar-right">
          <li><a href="/web/20140525025619/http://www.dartvoid.com:80/pricing/">Pricing</a></li>
          <li><a href="/web/20140525025619/http://www.dartvoid.com:80/vane/">Vane</a></li>
          <li><a href="/web/20140525025619/http://www.dartvoid.com:80/docs/">Docs</a></li>
          <li><a href="/web/20140525025619/http://www.dartvoid.com:80/community/">Community</a></li>
          <li><a href="/web/20140525025619/http://www.dartvoid.com:80/about/">Company</a></li>
          <li><a href="/web/20140525025619/http://www.dartvoid.com:80/signup/">Sign up</a></li>
          <li><a href="https://web.archive.org/web/20140525025619/https://manage.dartvoid.com/"><i class="fa fa-sign-in"></i> Sign in</a></li>
        </ul>
      </nav>
    </div>
  </header>

  

  <header class="navbar navbar-default">
    <div class="container">
      <nav>
        <ul class="nav navbar-nav">
          <li class="">
            <a href="/web/20140525025619/http://www.dartvoid.com:80/vane/">Overview</a>
          </li>
          <li class="">
            <a href="/web/20140525025619/http://www.dartvoid.com:80/vane/middlewares/">Middlewares</a>
          </li>
          <li class=" active">
            <a href="/web/20140525025619/http://www.dartvoid.com:80/vane/databases/">Database access</a>
          </li>
          <li class="">
            <a href="/web/20140525025619/http://www.dartvoid.com:80/vane/roadmap/">Roadmap</a>
          </li>
          <li><a href="/web/20140525025619/http://www.dartvoid.com:80/docs/vaneapi/">Vane API <i class="fa fa-external-link"></i></a></li>
          <li><a href="https://web.archive.org/web/20140525025619/https://github.com/DartVoid/Vane" target="_blank">Vane Source <i class="fa fa-external-link"></i></a></li>
        </ul>
      </nav>
    </div>
  </header>


<div class="container content">
  <header class="masthead">
    <h1 class="header-strong">Database access</h1>
    <p class="lead"></p>
  </header>
  <div class="col-md-8 docs-left">
  <p>All applications on <a href="https://web.archive.org/web/20140525025619/http://www.dartvoid.com/">DartVoid</a> has their own <a href="https://web.archive.org/web/20140525025619/https://www.mongodb.org/">mongodb</a> database. 
And any framework running on DartVoid can get access to the applications database by fetching the <code>MONGODB_URI</code> variable from the environment.</p>

<p>Vane makes it extra easy for you and sets up a database object that you can access directly called <code>mongodb</code>. 
By using the database object, Vane can handle the connection for you, including closing the connection to the database.</p>

<p>Here are some example on how you can create, read and update the database from a dart program implemented with Vane running on DartVoid. </p>

<h2>Write to database</h2>
<div class="highlight"><pre><code class="dart language-dart" data-lang="dart"><span class="k">import</span> <span class="s1">&#39;dart:async&#39;</span><span class="p">;</span>                          <span class="c1">// Include dart&#39;s async library </span>
<span class="k">import</span> <span class="s1">&#39;package:vane/vane.dart&#39;</span><span class="p">;</span>              <span class="c1">// Include vane framework</span>
<span class="k">import</span> <span class="s1">&#39;package:mongo_dart/mongo_dart.dart&#39;</span><span class="p">;</span>  <span class="c1">// Include the mongodb library </span>

<span class="kd">class</span> <span class="nc">PostData</span> <span class="kd">extends</span> <span class="n">Vane</span> <span class="p">{</span>                 <span class="c1">// Extend the Vane class</span>
  <span class="n">Future</span> <span class="n">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="n">sessionId</span> <span class="o">=</span> <span class="n">query</span><span class="p">[</span><span class="s2">&quot;session&quot;</span><span class="p">];</span>         <span class="c1">// Fetch a value from the url query (eg. &quot;?session=12345&quot;)</span>

    <span class="c1">// Open a connection to the database</span>
    <span class="n">mongodb</span><span class="p">.</span><span class="n">then</span><span class="p">((</span><span class="n">mongodb</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// Create an object for the collection called &quot;sessions&quot;</span>
      <span class="n">DbCollection</span> <span class="n">sessions</span> <span class="o">=</span> <span class="n">mongodb</span><span class="p">.</span><span class="n">collection</span><span class="p">(</span><span class="s2">&quot;sessions&quot;</span><span class="p">);</span>

      <span class="c1">// Insert a new value to the database collection &quot;sessions&quot;</span>
      <span class="n">sessions</span><span class="p">.</span><span class="n">insert</span><span class="p">({</span><span class="s2">&quot;user&quot;</span><span class="o">:</span><span class="s2">&quot;Robert&quot;</span><span class="p">,</span> <span class="s2">&quot;session&quot;</span><span class="o">:</span><span class="n">sessionId</span><span class="p">}).</span><span class="n">then</span><span class="p">((</span><span class="n">_</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// When the new value has been saved, close the connection and return a message to the client</span>
        <span class="k">return</span> <span class="n">close</span><span class="p">(</span><span class="s2">&quot;Data saved!&quot;</span><span class="p">);</span>
      <span class="p">});</span>
    <span class="p">});</span>

    <span class="c1">// Return with &quot;end&quot; since we closed inside an async structure</span>
    <span class="k">return</span> <span class="n">end</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<h2>Read from database</h2>
<div class="highlight"><pre><code class="dart language-dart" data-lang="dart"><span class="k">import</span> <span class="s1">&#39;dart:async&#39;</span><span class="p">;</span>                          <span class="c1">// Include dart&#39;s async library </span>
<span class="k">import</span> <span class="s1">&#39;package:vane/vane.dart&#39;</span><span class="p">;</span>              <span class="c1">// Include vane framework</span>
<span class="k">import</span> <span class="s1">&#39;package:mongo_dart/mongo_dart.dart&#39;</span><span class="p">;</span>  <span class="c1">// Include the mongodb library </span>

<span class="kd">class</span> <span class="nc">GetData</span> <span class="kd">extends</span> <span class="n">Vane</span> <span class="p">{</span>                  <span class="c1">// Extend the Vane class</span>
  <span class="n">Future</span> <span class="n">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="c1">// Open a connection to the database</span>
    <span class="n">mongodb</span><span class="p">.</span><span class="n">then</span><span class="p">((</span><span class="n">mongodb</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// Create an object for the collection called &quot;sessions&quot;</span>
      <span class="n">DbCollection</span> <span class="n">coll</span> <span class="o">=</span> <span class="n">mongodb</span><span class="p">.</span><span class="n">collection</span><span class="p">(</span><span class="s2">&quot;sessions&quot;</span><span class="p">);</span>

      <span class="c1">// Find data for &quot;user&quot; in the &quot;sessions&quot; collection</span>
      <span class="n">coll</span><span class="p">.</span><span class="n">findOne</span><span class="p">({</span><span class="s2">&quot;user&quot;</span><span class="o">:</span><span class="s2">&quot;Robert&quot;</span><span class="p">}).</span><span class="n">then</span><span class="p">((</span><span class="n">data</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// Close the connection and send back the data to the client </span>
        <span class="c1">// as JSON using Vane&#39;s &quot;auto JSON&quot; function with close</span>
        <span class="k">return</span> <span class="n">close</span><span class="p">(</span><span class="n">data</span><span class="p">);</span>
      <span class="p">});</span>
    <span class="p">});</span>

    <span class="c1">// Return with &quot;end&quot; since we close inside an async structure</span>
    <span class="k">return</span> <span class="n">end</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<h2>Update entry in database</h2>
<div class="highlight"><pre><code class="dart language-dart" data-lang="dart"><span class="k">import</span> <span class="s1">&#39;dart:async&#39;</span><span class="p">;</span>
<span class="k">import</span> <span class="s1">&#39;package:vane/vane.dart&#39;</span><span class="p">;</span>
<span class="k">import</span> <span class="s1">&#39;package:mongo_dart/mongo_dart.dart&#39;</span><span class="p">;</span>

<span class="kd">class</span> <span class="nc">UpdateData</span> <span class="kd">extends</span> <span class="n">Vane</span> <span class="p">{</span>
  <span class="n">Future</span> <span class="n">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="n">sessionId</span> <span class="o">=</span> <span class="n">query</span><span class="p">[</span><span class="s2">&quot;session&quot;</span><span class="p">];</span>         <span class="c1">// Fetch a value from the url query (eg. &quot;?session=12345&quot;)</span>

    <span class="c1">// Open a connection to the database</span>
    <span class="n">mongodb</span><span class="p">.</span><span class="n">then</span><span class="p">((</span><span class="n">mongodb</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// Create an object for the collection called &quot;sessions&quot;</span>
      <span class="n">DbCollection</span> <span class="n">coll</span> <span class="o">=</span> <span class="n">mongodb</span><span class="p">.</span><span class="n">collection</span><span class="p">(</span><span class="s2">&quot;sessions&quot;</span><span class="p">);</span>

      <span class="c1">// Find record and update the users name</span>
      <span class="n">coll</span><span class="p">.</span><span class="n">findOne</span><span class="p">({</span><span class="s2">&quot;session&quot;</span><span class="o">:</span><span class="n">sessionId</span><span class="p">}).</span><span class="n">then</span><span class="p">((</span><span class="n">data</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">data</span><span class="p">[</span><span class="s2">&quot;user&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Rob&quot;</span><span class="p">;</span>
        <span class="n">coll</span><span class="p">.</span><span class="n">save</span><span class="p">(</span><span class="n">data</span><span class="p">);</span>

        <span class="c1">// Close the connection with the db response</span>
        <span class="k">return</span> <span class="n">close</span><span class="p">(</span><span class="s2">&quot;Username updated&quot;</span><span class="p">);</span>
      <span class="p">});</span>
    <span class="p">});</span>

    <span class="c1">// Return with &quot;end&quot; since we close inside an async structure</span>
    <span class="k">return</span> <span class="n">end</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<h2>Delete entry in database</h2>
<div class="highlight"><pre><code class="dart language-dart" data-lang="dart"><span class="k">import</span> <span class="s1">&#39;dart:async&#39;</span><span class="p">;</span>
<span class="k">import</span> <span class="s1">&#39;package:vane/vane.dart&#39;</span><span class="p">;</span>
<span class="k">import</span> <span class="s1">&#39;package:mongo_dart/mongo_dart.dart&#39;</span><span class="p">;</span>

<span class="kd">class</span> <span class="nc">DeleteData</span> <span class="kd">extends</span> <span class="n">Vane</span> <span class="p">{</span>
  <span class="n">Future</span> <span class="n">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="n">sessionId</span> <span class="o">=</span> <span class="n">query</span><span class="p">[</span><span class="s2">&quot;session&quot;</span><span class="p">];</span>         <span class="c1">// Fetch a value from the url query (eg. &quot;?session=12345&quot;)</span>

    <span class="c1">// Open a connection to the database</span>
    <span class="n">mongodb</span><span class="p">.</span><span class="n">then</span><span class="p">((</span><span class="n">mongodb</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// Create an object for the collection called &quot;sessions&quot;</span>
      <span class="n">DbCollection</span> <span class="n">coll</span> <span class="o">=</span> <span class="n">mongodb</span><span class="p">.</span><span class="n">collection</span><span class="p">(</span><span class="s2">&quot;sessions&quot;</span><span class="p">);</span>

      <span class="c1">// Remove records where session = sessionId</span>
      <span class="n">coll</span><span class="p">.</span><span class="n">remove</span><span class="p">({</span><span class="s2">&quot;session&quot;</span><span class="o">:</span><span class="n">sessionId</span><span class="p">}).</span><span class="n">then</span><span class="p">((</span><span class="n">data</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// Close the connection with the db response</span>
        <span class="k">return</span> <span class="n">close</span><span class="p">(</span><span class="n">data</span><span class="p">);</span>
      <span class="p">});</span>
    <span class="p">});</span>

    <span class="c1">// Return with &quot;end&quot; since we close inside an async structure</span>
    <span class="k">return</span> <span class="n">end</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<h2>Read all data from a collection</h2>
<div class="highlight"><pre><code class="dart language-dart" data-lang="dart"><span class="k">import</span> <span class="s1">&#39;dart:async&#39;</span><span class="p">;</span>
<span class="k">import</span> <span class="s1">&#39;package:vane/vane.dart&#39;</span><span class="p">;</span>
<span class="k">import</span> <span class="s1">&#39;package:mongo_dart/mongo_dart.dart&#39;</span><span class="p">;</span>

<span class="kd">class</span> <span class="nc">GetDatas</span> <span class="kd">extends</span> <span class="n">Vane</span> <span class="p">{</span>
  <span class="n">Future</span> <span class="n">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="c1">// Open a connection to the database</span>
    <span class="n">mongodb</span><span class="p">.</span><span class="n">then</span><span class="p">((</span><span class="n">mongodb</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// Create an object for the collection called &quot;sessions&quot;</span>
      <span class="n">DbCollection</span> <span class="n">coll</span> <span class="o">=</span> <span class="n">mongodb</span><span class="p">.</span><span class="n">collection</span><span class="p">(</span><span class="s2">&quot;sessions&quot;</span><span class="p">);</span>

      <span class="c1">// Find all entries where user = &quot;Robert&quot;, then convert them to a list </span>
      <span class="n">coll</span><span class="p">.</span><span class="n">find</span><span class="p">({</span><span class="s2">&quot;user&quot;</span><span class="o">:</span><span class="s2">&quot;Robert&quot;</span><span class="p">}).</span><span class="n">toList</span><span class="p">().</span><span class="n">then</span><span class="p">((</span><span class="n">data</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// And then... Close the connection and send back the data to the client </span>
        <span class="c1">// as JSON using Vane&#39;s &quot;auto JSON&quot; function with close</span>
        <span class="k">return</span> <span class="n">close</span><span class="p">(</span><span class="n">data</span><span class="p">);</span>
      <span class="p">});</span>
    <span class="p">});</span>

    <span class="c1">// Return with &quot;end&quot; since we close inside an async structure</span>
    <span class="k">return</span> <span class="n">end</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
  </div>
</div>
  <footer>
    <nav class="navbar navbar-default navbar-fixed-bottom" role="navigation">
      <div class="container">
        <div class="navbar-header">
          <button class="navbar-toggle collapsed" type="button" data-toggle="collapse" data-target=".navbar-collapse-footer">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
        </div>
        
        <nav class="collapse navbar-collapse navbar-collapse-footer" role="navigation">
          <div class="row">
            <div class="footer-content col-md-6 col-sm-6">
              <p>Â© 2012 - 2014 DartVoid</p>
            </div>
                  
            <div class="footer-content col-md-6 col-sm-6">
              <ul class="nav navbar-nav navbar-right">
                <li><a href="/web/20140525025619/http://www.dartvoid.com:80/support/#consultation">Consultation</a></li>
                <li><a href="/web/20140525025619/http://www.dartvoid.com:80/support/#training">Training</a></li>
                <li><a href="https://web.archive.org/web/20140525025619/http://blog.dartvoid.com/" target="_blank">Blog <i class="fa fa-external-link"></i></a></li>
                <li><a href="/web/20140525025619/http://www.dartvoid.com:80/about/">About</a></li>
              </ul>
            </div>
          </div>
        </nav>
      </div>
    </nav>
  </footer>  
</body>
</html>


<script pagespeed_no_defer="">(function(){var e=window,f=Math,g="round",h="performance";e.pagespeed=e.pagespeed||{};var q=e.pagespeed;
q.getResourceTimingData=function(){if(e[h]&&(e[h].getEntries||e[h].webkitGetEntries)){for(var r=0,s=0,k=0,t=0,l=0,u=0,m=0,v=0,n=0,w=0,p=0,c={},d=e[h].getEntries?e[h].getEntries():e[h].webkitGetEntries(),b=0;b<d.length;b++){var a=d[b].duration;0<a&&(r+=a,++k,s=f.max(s,a));a=d[b].connectEnd-d[b].connectStart;0<a&&(u+=a,++m);a=d[b].domainLookupEnd-d[b].domainLookupStart;0<a&&(t+=a,++l);a=d[b].initiatorType;c[a]?++c[a]:c[a]=1;a=d[b].requestStart-d[b].fetchStart;0<a&&(w+=a,++p);a=d[b].responseStart-d[b].requestStart;
0<a&&(v+=a,++n)}return"&afd="+(k?f[g](r/k):0)+"&nfd="+k+"&mfd="+f[g](s)+"&act="+(m?f[g](u/m):0)+"&nct="+m+"&adt="+(l?f[g](t/l):0)+"&ndt="+l+"&abt="+(p?f[g](w/p):0)+"&nbt="+p+"&attfb="+(n?f[g](v/n):0)+"&nttfb="+n+(c.css?"&rit_css="+c.css:"")+(c.link?"&rit_link="+c.link:"")+(c.script?"&rit_script="+c.script:"")+(c.img?"&rit_img="+c.img:"")}return""};q.getResourceTimingData=q.getResourceTimingData;})();
(function(){var c=encodeURIComponent,g=window,h="performance";g.pagespeed=g.pagespeed||{};var l=g.pagespeed,m=function(f,a,d,b){this.c=f;this.a=a;this.b=d;this.d=b};l.beaconUrl="";
var n=function(f){var a=f.c,d=g.mod_pagespeed_start,b=Number(new Date)-d,a=a+(-1==a.indexOf("?")?"?":"&"),a=a+"ets="+("load"==f.a?"load:":"unload:"),a=a+b;if("beforeunload"!=f.a||!g.mod_pagespeed_loaded){a+="&r"+f.a+"=";if(g[h]){var b=g[h].timing,e=b.navigationStart,k=b.requestStart,a=a+(b[f.a+"EventStart"]-e),a=a+("&nav="+(b.fetchStart-e)),a=a+("&dns="+(b.domainLookupEnd-b.domainLookupStart)),a=a+("&connect="+(b.connectEnd-b.connectStart)),a=a+("&req_start="+(k-e)),a=a+("&ttfb="+(b.responseStart-
k)),a=a+("&dwld="+(b.responseEnd-b.responseStart)),a=a+("&dom_c="+(b.domContentLoadedEventStart-e));g[h].navigation&&(a+="&nt="+g[h].navigation.type);e=-1;b.msFirstPaint?e=b.msFirstPaint:g.chrome&&g.chrome.loadTimes&&(e=Math.floor(1E3*g.chrome.loadTimes().firstPaintTime));e=e-k;0<=e&&(a+="&fp="+e)}else a+=b;l.getResourceTimingData&&g.parent==g&&(a+=l.getResourceTimingData());a+=g.parent!=g?"&ifr=1":"&ifr=0";"load"==f.a&&(g.mod_pagespeed_loaded=!0,(b=g.mod_pagespeed_num_resources_prefetched)&&(a+=
"&nrp="+b),(b=g.mod_pagespeed_prefetch_start)&&(a+="&htmlAt="+(d-b)));l.panelLoader&&(d=l.panelLoader.getCsiTimingsString(),""!=d&&(a+="&b_csi="+d));l.criticalCss&&(d=l.criticalCss,a+="&ccis="+d.total_critical_inlined_size+"&cces="+d.total_original_external_size+"&ccos="+d.total_overhead_size+"&ccrl="+d.num_replaced_links+"&ccul="+d.num_unreplaced_links);""!=f.b&&(a+=f.b);document.referrer&&(a+="&ref="+c(document.referrer));a+="&url="+c(f.d);l.beaconUrl=a;(new Image).src=a}};
l.e=function(f,a,d,b){var e=new m(f,a,d,b);g.addEventListener?g.addEventListener(a,function(){n(e)},!1):g.attachEvent("on"+a,function(){n(e)})};l.addInstrumentationInit=l.e;})();

pagespeed.addInstrumentationInit('https://web.archive.org/web/20140525025619/http://1-ps.googleusercontent.com/beacon?org=119_1_li', 'load', '&s_ttfb=147&id=1400986578803568', 'https://web.archive.org/web/20140525025619/http://www.dartvoid.com/vane/databases/');</script><!--
     FILE ARCHIVED ON 02:56:19 May 25, 2014 AND RETRIEVED FROM THE
     INTERNET ARCHIVE ON 07:08:21 Jan 17, 2019.
     JAVASCRIPT APPENDED BY WAYBACK MACHINE, COPYRIGHT INTERNET ARCHIVE.

     ALL OTHER CONTENT MAY ALSO BE PROTECTED BY COPYRIGHT (17 U.S.C.
     SECTION 108(a)(3)).
-->
<!--
playback timings (ms):
  LoadShardBlock: 223.704 (3)
  esindex: 0.007
  captures_list: 236.688
  CDXLines.iter: 9.018 (3)
  PetaboxLoader3.datanode: 155.927 (4)
  exclusion.robots: 0.286
  exclusion.robots.policy: 0.273
  RedisCDXSource: 1.492
  PetaboxLoader3.resolve: 250.65 (4)
  load_resource: 207.949
-->
